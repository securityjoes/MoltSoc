:root {
  --bg: #0c1117;
  --surface: #161b22;
  --border: #30363d;
  --text: #e6edf3;
  --muted: #8b949e;
  --info: #388bfd;
  --low: #3fb950;
  --medium: #d29922;
  --high: #f85149;
  --critical: #da3633;
  --font: system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
  --font-mono: ui-monospace, 'Cascadia Mono', 'SF Mono', monospace;
}

* { box-sizing: border-box; }
body { margin: 0; font-family: var(--font); font-size: 13px; background: var(--bg); color: var(--text); min-height: 100vh; line-height: 1.5; }
#root { min-height: 100vh; }

.app { display: flex; flex-direction: column; min-height: 100vh; }
.app-header { padding: 12px 20px; border-bottom: 1px solid var(--border); display: flex; align-items: center; gap: 16px; flex-wrap: wrap; }
.app-header h1 { margin: 0; font-size: 1.25rem; font-weight: 600; }
.link-openclaw { font-size: 12px; color: var(--info); text-decoration: none; padding: 6px 10px; border: 1px solid var(--border); border-radius: 4px; }
.link-openclaw:hover { text-decoration: underline; background: var(--surface); }
.data-source { display: flex; align-items: center; gap: 8px; margin-left: auto; flex-wrap: wrap; }
.data-source input[type="text"] { width: 220px; padding: 6px 10px; background: var(--surface); border: 1px solid var(--border); color: var(--text); border-radius: 4px; font-family: inherit; }
.data-source label { display: flex; align-items: center; gap: 6px; cursor: pointer; color: var(--muted); }
.data-source input[type="checkbox"] { accent-color: var(--info); }
.app-body { display: flex; flex: 1; min-height: 0; }
.app-sidebar { width: 200px; min-width: 200px; border-right: 1px solid var(--border); display: flex; flex-direction: column; background: var(--surface); }
.side-nav { display: flex; flex-direction: column; padding: 12px 0; }
.side-nav-item { padding: 10px 16px; text-align: left; background: none; border: none; border-left: 3px solid transparent; color: var(--text); cursor: pointer; font-family: inherit; font-size: 13px; }
.side-nav-item:hover { background: rgba(255,255,255,0.05); }
.side-nav-item.active { background: rgba(88,166,255,0.12); border-left-color: var(--info); color: var(--info); }
.security-analyst-banner { margin-top: auto; padding: 16px; border-top: 1px solid var(--border); font-size: 12px; }
.security-analyst-banner h4 { margin: 0 0 8px 0; font-size: 12px; color: var(--muted); text-transform: uppercase; letter-spacing: 0.05em; }
.security-analyst-banner p { margin: 0 0 8px 0; color: var(--text); line-height: 1.4; }
.security-analyst-banner p.analyst-heartbeat { color: var(--low); font-size: 11px; }
.security-analyst-banner p.analyst-heartbeat.muted { color: var(--muted); }
.security-analyst-banner code { font-size: 11px; background: var(--bg); padding: 2px 6px; border-radius: 4px; }
.app-main { flex: 1; display: flex; flex-direction: column; min-width: 0; overflow: hidden; }
.drop-zone { border: 2px dashed var(--border); border-radius: 8px; padding: 24px; text-align: center; color: var(--muted); margin: 12px 20px; }
.drop-zone.dragover { border-color: var(--info); background: rgba(88,166,255,0.08); }
.drop-zone code { font-size: 12px; }
.panel { flex: 1; padding: 16px 20px; overflow: auto; }
.table-wrap { overflow: auto; max-height: 70vh; }
table { width: 100%; border-collapse: collapse; }
th, td { padding: 8px 12px; text-align: left; border-bottom: 1px solid var(--border); }
th { position: sticky; top: 0; background: var(--surface); z-index: 1; font-weight: 600; color: var(--muted); }
tr:hover { background: var(--surface); }
.severity-info { color: var(--info); }
.severity-low { color: var(--low); }
.severity-medium { color: var(--medium); }
.severity-high { color: var(--high); }
.severity-critical { color: var(--critical); }
.rules-panel { max-width: 560px; }
.rules-panel ul { list-style: none; padding: 0; margin: 0; }
.rules-panel .rule-item { padding: 10px 12px; border: 1px solid var(--border); border-radius: 6px; margin-bottom: 8px; background: var(--surface); }
.rules-panel li.rule-item h4 { margin: 0 0 4px 0; font-size: 13px; }
.rules-panel li.rule-item p { margin: 0; color: var(--muted); font-size: 12px; }
.rules-panel .rule-item-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px; }
.rules-panel .rule-item-header h4 { margin: 0; }
.rules-panel .rule-delete { background: none; border: none; color: var(--muted); font-size: 18px; cursor: pointer; padding: 0 4px; line-height: 1; }
.rules-panel .rule-delete:hover { color: var(--high); }
.rules-panel .rule-edit-btn { padding: 4px 10px; margin-right: 4px; background: var(--surface); border: 1px solid var(--border); color: var(--info); border-radius: 4px; cursor: pointer; font-family: inherit; font-size: 12px; }
.rules-panel .rule-edit-btn:hover { background: var(--border); }
.rules-panel .rule-detail { margin: 8px 0 0 0; padding-top: 8px; border-top: 1px solid var(--border); }
.rules-panel .rule-description { margin: 0 0 6px 0; font-size: 12px; color: var(--muted); line-height: 1.4; }
.rules-panel .rule-example { margin: 0; font-size: 12px; color: var(--text); }
.rules-panel .rule-example-label { color: var(--muted); margin-right: 4px; }
.rules-panel .rule-example code { font-size: 11px; background: var(--bg); padding: 2px 6px; border-radius: 4px; word-break: break-all; }
.rules-panel .rule-meta { margin: 8px 0 0 0; font-size: 12px; color: var(--muted); }
.rules-panel input[type="number"] { width: 60px; padding: 4px; background: var(--bg); border: 1px solid var(--border); color: var(--text); border-radius: 4px; margin-left: 8px; font-family: inherit; }
.rule-edit-form { padding: 8px 0; }
.rule-edit-form .rule-edit-row { margin-bottom: 10px; }
.rule-edit-form .rule-edit-row label { display: block; margin-bottom: 4px; font-size: 12px; color: var(--muted); }
.rule-edit-form .rule-edit-row input[type="text"], .rule-edit-form .rule-edit-row input[type="number"], .rule-edit-form .rule-edit-row select { width: 100%; max-width: 320px; padding: 6px 8px; background: var(--bg); border: 1px solid var(--border); color: var(--text); border-radius: 4px; font-family: inherit; }
.rule-edit-form .rule-edit-row textarea { width: 100%; max-width: 480px; padding: 6px 8px; background: var(--bg); border: 1px solid var(--border); color: var(--text); border-radius: 4px; font-family: inherit; font-size: 12px; resize: vertical; }
.rule-edit-form .rule-edit-actions { margin-top: 12px; display: flex; gap: 8px; }
.rule-add-form { margin-top: 16px; padding: 12px; border: 1px dashed var(--border); border-radius: 6px; background: var(--surface); }
.rule-add-form h4 { margin: 0 0 8px 0; font-size: 13px; color: var(--muted); }
.rule-add-row { display: flex; flex-wrap: wrap; gap: 8px; align-items: center; margin-bottom: 8px; }
.rule-add-row input[type="text"] { width: 160px; padding: 6px 8px; background: var(--bg); border: 1px solid var(--border); color: var(--text); border-radius: 4px; font-family: inherit; }
.rule-add-row input[type="number"] { width: 70px; margin-left: 0; }
.rule-add-row select { padding: 6px 8px; background: var(--bg); border: 1px solid var(--border); color: var(--text); border-radius: 4px; font-family: inherit; }
.rule-add-field { margin-bottom: 10px; }
.rule-add-field label { display: block; margin-bottom: 4px; font-size: 12px; color: var(--muted); }
.rule-add-field textarea { width: 100%; max-width: 480px; padding: 6px 8px; background: var(--bg); border: 1px solid var(--border); color: var(--text); border-radius: 4px; font-family: inherit; font-size: 12px; resize: vertical; }
.rule-add-actions { display: flex; gap: 8px; }
.btn-add { padding: 6px 12px; background: var(--info); color: var(--bg); border: none; border-radius: 4px; cursor: pointer; font-family: inherit; }
.btn-cancel { padding: 6px 12px; background: var(--surface); color: var(--text); border: 1px solid var(--border); border-radius: 4px; cursor: pointer; font-family: inherit; }
.btn-new-rule { margin-top: 12px; padding: 8px 14px; background: var(--surface); border: 1px dashed var(--border); color: var(--info); border-radius: 6px; cursor: pointer; font-family: inherit; }
.btn-new-rule:hover { background: var(--border); }
.btn-save-rules { margin-top: 12px; padding: 8px 16px; cursor: pointer; background: var(--info); color: var(--bg); border: none; border-radius: 6px; font-family: inherit; }
.ai-context { display: flex; flex-direction: column; max-width: 100%; }
.ai-context-intro { color: var(--muted); margin: 0 0 12px 0; font-size: 13px; }
.ai-context-actions { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 12px; }
.btn-copy-context, .btn-send-context, .btn-toggle-json { padding: 8px 14px; background: var(--info); color: var(--bg); border: none; border-radius: 6px; cursor: pointer; font-family: inherit; font-size: 13px; }
.btn-copy-context:hover, .btn-send-context:hover, .btn-toggle-json:hover { opacity: 0.9; }
.btn-toggle-json { background: var(--surface); color: var(--text); border: 1px solid var(--border); }
.ai-chat-embed { flex: 1; min-height: 420px; border: 1px solid var(--border); border-radius: 8px; overflow: hidden; background: var(--surface); }
.ai-chat-iframe { width: 100%; height: 100%; min-height: 420px; border: none; display: block; }
.ai-context-json-wrap { margin-top: 12px; }
.ai-context-json-wrap summary { cursor: pointer; color: var(--muted); font-size: 12px; }
.ai-context-text { background: var(--surface); border: 1px solid var(--border); border-radius: 6px; padding: 12px; font-size: 12px; line-height: 1.5; overflow: auto; max-height: 40vh; white-space: pre-wrap; word-break: break-word; margin: 8px 0 0 0; }
.ai-context-no-embed { max-width: 640px; }
.ai-context-no-embed p { margin: 0 0 8px 0; color: var(--muted); font-size: 13px; }
.ai-context-no-embed code { font-size: 12px; background: var(--surface); padding: 2px 6px; border-radius: 4px; }
.ai-context-env { background: var(--surface); border: 1px solid var(--border); border-radius: 6px; padding: 12px; font-size: 12px; margin: 8px 0 12px 0; white-space: pre-wrap; }
.map-placeholder { padding: 48px; text-align: center; color: var(--muted); border: 1px dashed var(--border); border-radius: 8px; }
.filter-row { display: flex; gap: 12px; margin-bottom: 12px; flex-wrap: wrap; }
.filter-row input, .filter-row select { padding: 6px 10px; background: var(--surface); border: 1px solid var(--border); color: var(--text); border-radius: 4px; font-family: inherit; }
.bot-selector { padding: 6px 10px; background: var(--surface); border: 1px solid var(--border); color: var(--text); border-radius: 4px; font-family: inherit; min-width: 140px; }
.live-error { color: var(--medium); font-size: 11px; margin-left: 4px; }
.alerts-filter-banner { display: flex; align-items: center; gap: 12px; padding: 10px 14px; margin-bottom: 12px; background: var(--surface); border: 1px solid var(--border); border-radius: 6px; }
.alerts-filter-label { color: var(--muted); font-size: 12px; }
.alerts-filter-clear { padding: 4px 12px; background: transparent; border: 1px solid var(--border); color: var(--info); border-radius: 4px; cursor: pointer; font-family: inherit; font-size: 12px; }
.alerts-filter-clear:hover { background: var(--border); }
.link-button { background: none; border: none; color: var(--info); cursor: pointer; font-family: inherit; font-size: inherit; text-decoration: underline; padding: 0; margin-left: 4px; }
.alerts-empty { color: var(--muted); margin: 0 0 16px 0; font-size: 13px; }
.alerts-empty code { font-size: 12px; }

.overview { padding: 0 4px; }
.overview-kpis { display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 12px; margin-bottom: 24px; }
.kpi-card { display: flex; flex-direction: column; align-items: flex-start; padding: 16px; background: var(--surface); border: 1px solid var(--border); border-radius: 8px; cursor: pointer; transition: border-color 0.15s, background 0.15s; text-align: left; font-family: inherit; }
.kpi-card:hover { border-color: var(--info); background: rgba(56, 139, 253, 0.06); }
.kpi-value { font-size: 1.5rem; font-weight: 600; color: var(--text); line-height: 1.2; }
.kpi-label { font-size: 11px; color: var(--muted); text-transform: uppercase; letter-spacing: 0.04em; margin-top: 4px; }
.kpi-card.kpi-critical .kpi-value { color: var(--critical); }
.kpi-card.kpi-high .kpi-value { color: var(--high); }
.kpi-card.kpi-medium .kpi-value { color: var(--medium); }
.kpi-card.kpi-alerts .kpi-value { color: var(--info); }
.overview-charts { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 24px; }
@media (max-width: 900px) { .overview-charts { grid-template-columns: 1fr; } }
.overview-chart-card { padding: 20px; background: var(--surface); border: 1px solid var(--border); border-radius: 8px; }
.overview-chart-card h3 { margin: 0 0 4px 0; font-size: 14px; font-weight: 600; color: var(--text); }
.chart-hint { margin: 0 0 12px 0; font-size: 11px; color: var(--muted); }
.chart-empty { padding: 40px 20px; text-align: center; color: var(--muted); font-size: 13px; }
.overview-chart-full { grid-column: 1 / -1; }
.chart-clickable { cursor: pointer; }
.chart-bar-clickable { cursor: pointer; }
.recharts-default-tooltip { padding: 8px 12px; background: var(--surface); border: 1px solid var(--border); border-radius: 6px; font-size: 12px; }
.recharts-legend-item-text { color: var(--muted); font-size: 12px; }
.recharts-cartesian-axis-tick-value { fill: var(--muted); font-size: 11px; }
.drawer-btn { padding: 4px 8px; background: var(--surface); border: 1px solid var(--border); color: var(--info); border-radius: 4px; cursor: pointer; font-family: inherit; font-size: 12px; }
.alert-drawer-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 100; display: flex; align-items: center; justify-content: center; }
.alert-drawer { background: var(--surface); border: 1px solid var(--border); border-radius: 8px; max-width: 480px; width: 90%; max-height: 80vh; overflow: auto; }
.alert-drawer-header { display: flex; justify-content: space-between; align-items: center; padding: 12px 16px; border-bottom: 1px solid var(--border); }
.alert-drawer-header h3 { margin: 0; font-size: 14px; }
.drawer-close { background: none; border: none; color: var(--muted); font-size: 20px; cursor: pointer; padding: 0 4px; }
.alert-drawer-body { padding: 16px; }
.alert-drawer-body p { margin: 0 0 8px 0; font-size: 13px; }
.evidence-list { margin: 8px 0 0 0; padding-left: 20px; }
.evidence-item { margin-bottom: 4px; }
.evidence-item code { font-size: 11px; word-break: break-all; }
.map-view { display: flex; flex-direction: column; gap: 20px; }
.map-section h4 { margin: 0 0 8px 0; font-size: 13px; color: var(--muted); }
.map-list { list-style: none; padding: 0; margin: 0; }
.map-list li { padding: 6px 0; border-bottom: 1px solid var(--border); display: flex; align-items: center; gap: 8px; }
.map-list .count { color: var(--muted); font-size: 12px; }
.sparkline { display: flex; align-items: flex-end; gap: 2px; height: 48px; margin-top: 8px; }
.sparkline-bar { min-width: 4px; background: var(--info); border-radius: 2px; }
.map-placeholder .map-hint { margin-top: 8px; font-size: 12px; }
.map-placeholder code { font-size: 11px; }
